---
title: "单文件重命名工具"
date: 2024-07-19 22:17:21 +0800
last_modified_at: 2025-01-23 09:52:44 +0800
categories:
- blog
tags: 
- ahk
---
# 一、概述
该工具是为了将软件存档时，进行重命名使用，目的是规范命名， 将不同时期的软件按照统一格式进行命名，否则每次整理都忘了之前的命名方式， 导致存放混乱的问题。  
![文件管理器演示](/assets/blog/20240719/软件重命名工具演示.jpg)   
也可以对普通文件或者文档改名使用, 使其条理更清晰。
![[/assets/blog/20240719/20240720130805.bmp]]

# 二、安装指南
本程序使用的是 `Autohotkey2` 进行编写，电脑上需要安装 [AHK2](https://www.autohotkey.com/) 才可以使用。本工具无需安装。

# 三、功能介绍及使用说明
所有的功能以脚本的具体实现为准, 可能在后续使用的过程中进行调整。   
鼠标点击选中相关程序或文件夹，按 `win + F2` 会出现重命名菜单，默认快捷键可以自己编辑ahk文件进行修改。  
只能对单个文件进行重命名, 无法批量命名。  
目前修改后名称有两种排序方式, 如果文件名是文档类型, 则排序方式为:  
`分类_二级分类_名称_日期_版本_是否插件_是否官方_是否便携_备注_扩展名`  
否则,默认排序为:  
`分类_二级分类_名称_是否插件_版本_是否官方_是否便携_日期_备注_扩展名`  
![软件重命名](/assets/blog/20240719/20240719223620.bmp)  
## 1.分类
自带了10个一级分类，其中第10项为空，如果一级分类不够细分， 可以自己手填二级分类，后面的`删除`只删除`二级`里面的内容， 不会对最前面的`分类`产生影响。  
二级分类存在的目的是为了一级分类如果不匹配， 完全抛弃一级分类， 直接把分类写在此处，代价是本程序再打开该命名时， 会无法识别自己添加的分类， 需要点击`名称`后面的按钮`分`，才能将二级分类识别。

## 2.名称
此处的名称是去掉所有其他信息后的纯名称。  
按钮1 `分`： 如果名称中下划线`_`存在，则还可以将它细分，将第一个下划线前面的内容移到`二级`里面，如果`二级`里面已经有内容， 则把内容挪到`名称`中。  
按钮2 `搜索`：利用百度搜索前面的名称  

## 3.附属
使用的机会并不多， 主要是标注一些插件、存档使用  

## 4.版本
以在名称中`_v`开头，如果有后缀则直接跟在后面，类似beta， build    
按钮1 `获取`：如果是exe文件，则尝试获取它的版本号，正规软件一般可以， 如果无法获取，则将版本号改为`1`  
按钮2 `恢复`：恢复为原文件名中的版本号，目的是点击`获取`后的版本号如果错误， 则用这个按钮恢复  

## 5.来源
标记是否官方，后面的两个按钮是快捷选择  

## 6.便携
标记是否安装包  

## 7.日期
在文件名中以`_d`开头，采用格式为`240718`   
按钮1 `修改时间`：获取文件的最后修改时间  
按钮2 `今天`： 获取今天的时间  
按钮3 `删除`： 删除时间  

## 8.备注
其他额外的说明，在文件名中以`_&`开头  

## 9.刷新
更新`修改后名称`中的内容，理论上会自动更新  

## 10.7zip压缩
前提是电脑是安装`7zip`，利用7zip将文件夹或文件进行压缩为自解压文件  

# 四、常见问题
## 1.文件名识别错误的问题
文件名分解是用的内置函数`SplitPath`, 有一些内在缺陷, 如果里面点`.`多的话, 扩展名会出现错误  
## 2.日期的格式
采用的是`240101`这种年月日格式，`2024-07-18` 占用太长， 没有使用，识别的时候，如果以前有这种格式，还恰巧是`_d`开头，会导致程序识别错误  
## 3.分隔符
名称中各项中间使用下划线`_`进行分隔  
空格可能出现在名称中，所有没有使用  
点`.`出现在版本中， 所有没有使用  
## 4.网络位置的文件
如果是网络驱动器(Z:),由于ahk不支持在网络驱动器中更正名字, 并且ahk也无法通过网络驱动器获取UNC地址(类似\\Workstation01),  如果需要更名网络驱动器的文件, 可以从`网络`面板中找到该电脑上的文件进行修改。

# 五、技术支持
无  
正如一千个读者就有一千个哈姆雷特，每个人的`ahk`的使用习惯也不尽相同，如果不合你意，可以自行修改; 如果你没接触过`ahk`，这里有一份[初学者向导](https://wyagd001.github.io/v2/docs/Tutorial.htm)。    

# 六、参考资料
1. [我是如何管理7000+软件的？ - 小众软件](https://www.appinn.com/how-do-i-manage-7000-software/)  
2. [常见的软件版本编号及命名\_版本号命名规则exe-CSDN博客](https://blog.csdn.net/volkswageos/article/details/6489510/)  

# 七、修订和完善
2025-01-22:  
- 修复:启动时会检查文件地址,如果是网络驱动器(Z:),则提示失败。由于ahk不支持在网络驱动器中更正名字, 并且ahk也无法通过网络驱动器获取UNC地址(类似\\Workstation01),  如果需要更名网络驱动器的文件, 可以从`网络`面板中找到该电脑上的文件进行修改。  
- 修复: 下载链接错误  

2024-07-18：  
- 初版发布  

# 八、下载地址
下载地址：[软件重命名_v3_d250123.ahk](/assets/ahk/软件重命名_v3_d250123.ahk)  
AHK 备用下载地址: [AutoHotkey_v2.0.9](\assets\exe\01装机_AutoHotkey_v2.0.9_官方_安装包_d230923.exe)

# 九、版权
LIC： [GNU GPLv2](https://wyagd001.github.io/v2/docs/license.htm) 


